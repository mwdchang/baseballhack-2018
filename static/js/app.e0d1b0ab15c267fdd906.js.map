{"version":3,"sources":["webpack:///./src/util/firebase.js","webpack:///./src/util/stats.js","webpack:///src/components/survey.vue","webpack:///./src/components/survey.vue?0a60","webpack:///./src/components/survey.vue","webpack:///./src/util/scenarios.js","webpack:///src/App.vue","webpack:///./src/App.vue?532c","webpack:///./src/App.vue","webpack:///./src/main.js"],"names":["database","firebase","initializeApp","apiKey","authDomain","databaseURL","console","log","path","ref","once","value","set","batting","data","forEach","d","id","playerID","hasOwnProperty","HR","AB","H","W","formatter","d3","format","survey","remove","sc","canvas","create","_this","this","transition","duration","ease","easeLinear","attr","x","y","_this2","processResults","_this3","getTime","players","_this4","val","length","img","len","agg","resultCanvas","k","enter","append","classed","i","on","style","text","player","url","scenario","_this5","drag","call","xaxis","yaxis","components_survey","render","_vm","_h","$createElement","_c","_self","staticClass","_v","_s","name","_e","staticStyle","display","flex-direction","click","submit","view","showResult","animate","_m","staticRenderFns","src_components_survey","__webpack_require__","normalizeComponent","ssrContext","scenarios_players","scenarios","idx","Math","floor","random","App","Survey","init","getScenario","getRandomScenario","selectortype_template_index_0_src_App","attrs","switchScenario","src_App","App_normalizeComponent","vue_esm","config","productionTip","el","components","template"],"mappings":"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","file":"static/js/app.e0d1b0ab15c267fdd906.js","sourcesContent":["let database = null;\n\nexport default class FB {\n  static init() {\n    const config = {\n      apiKey: 'AIzaSyDFqeomnCXYFfuIj3iSf5NpHBgRDUXGB4k',\n      authDomain: \"tripflow-1509338122882.firebaseapp.com\",\n      databaseURL: 'https://tripflow-1509338122882.firebaseio.com/',\n    };\n    firebase.initializeApp(config);\n    database = firebase.database();\n    console.log('firebase initialized...');\n  }\n\n  static readDB(path) {\n    return database.ref(path).once('value')\n  }\n  \n  static writeDB(path, value) {\n    return database.ref(path).set(value)\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/firebase.js","let batting = {};\n\nexport default class Stats {\n\n  static loadBatting(data) {\n    data.forEach( d => {\n      let id = d.playerID;\n      if (!batting.hasOwnProperty(id)) {\n        batting[id] = {\n          HR: 0,\n          AB: 0,\n          H: 0\n        };\n      }\n      batting[id].HR += +d['HR'];\n      batting[id].H += +d['H'];\n      batting[id].AB += +d['AB'];\n    });\n  }\n\n  static getPlayer(id) {\n    return batting[id];\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/stats.js","<template>\n  <div class=\"main-container\">\n\n    <div class=\"survey\">\n      <span v-if=\"scenario\"><strong>{{scenario.name}}</strong></span>\n      <div class=\"survey-container\">\n        <svg class=\"canvas-survey\">\n          <g></g>\n        </svg>\n      </div>\n      <div style=\"display:flex; flex-direction: row\">\n        <div class=\"button\" @click=\"submit\">Submit</div>\n        <div class=\"button\" @click=\"view\">View</div>\n      </div>\n    </div>\n\n    <div class=\"result\" v-if=\"showResult === true\">\n      <span v-if=\"scenario\"><strong>{{scenario.name}} (Average opinion)</strong></span>\n      <div class=\"result-container\">\n        <svg class=\"canvas-result\">\n          <g></g>\n        </svg>\n      </div>\n      <div class=\"button\" @click=\"animate\">Animate</div>\n    </div>\n\n    <div class=\"chart\" v-if=\"showResult === true\">\n      <span><strong>Difference</strong></span>\n      <div class=\"chart-container\">\n        <svg class=\"canvas-chart\">\n          <g></g>\n        </svg>\n      </div>\n    </div>\n\n\n  </div>\n</template>\n\n<script>\n\nconst H = 470;\nconst W = 470;\n\nconst formatter = d3.format(',');\n\nimport FB from '../util/firebase';\nimport Stats from '../util/stats';\n\nexport default {\n  name: 'survey',\n  props: ['sc'],\n  data() {\n    return {\n      scenario: null,\n      showResult: false\n    }\n  },\n  watch: {\n    sc: function scChanged() {\n      if (this.sc === null) return;\n\n      this.showResult = false;\n      this.canvas = d3.select('.canvas-survey').select('g');\n      this.canvas.selectAll('*').remove();\n\n      this.scenario = _.cloneDeep(this.sc);\n      this.initialize(this.canvas);\n      this.create();\n    }\n  },\n  mounted() {\n  },\n  methods: {\n    animate() {\n      const resultCanvas = d3.select('.canvas-result').select('g');\n      resultCanvas.selectAll('.player')\n        .transition()\n        .duration(800)\n        .ease(d3.easeLinear)\n        .attr('x', (d) => {\n          return _.find(this.scenario.players, p => p.id === d.id).x;\n        })\n        .attr('y', (d) => {\n          return _.find(this.scenario.players, p => p.id === d.id).y;\n        });\n\n      setTimeout(()=> {\n        resultCanvas.selectAll('.player')\n          .transition()\n          .duration(800)\n          .ease(d3.easeLinear)\n          .attr('x', (d) => {\n            return d.x;\n          })\n          .attr('y', (d) => {\n            return d.y;\n          });\n      }, 1000);\n    },\n    view() {\n      setTimeout(() => {\n        this.showResult = true;\n        this.processResults();\n      }, 300);\n    },\n    submit() {\n      const data = this.canvas.selectAll('.player').data();\n      const key = (new Date()).getTime();\n\n      FB.writeDB('/bh2018' + this.scenario.id + '/' + key, this.scenario.players);\n      this.showResult = true;\n      setTimeout(() => {\n        this.processResults();\n      }, 300);\n    },\n    processResults() {\n      FB.readDB('/bh2018' + this.scenario.id).then( resp => {\n        const results = resp.val();\n        const len = Object.keys(results).length;\n        const agg = {};\n\n        _.forEach(results, (v, k) => {\n          v.forEach( player => {\n            const id = player.id;\n            if (agg.hasOwnProperty(id) === false) {\n              agg[id] = {x:0, y:0, img: player.img};\n            }\n            agg[id].x += player.x;\n            agg[id].y += player.y;\n          });\n        });\n\n        _.forEach(agg, (v, k) => {\n          v.x /= len;\n          v.y /= len;\n        });\n\n        this.renderOther(agg);\n      });\n    },\n    renderOther(agg) {\n      const chartCanvas = d3.select('.canvas-chart').select('g');\n      chartCanvas.selectAll('*').remove();\n\n      const resultCanvas = d3.select('.canvas-result').select('g');\n      resultCanvas.selectAll('*').remove();\n      this.initialize(resultCanvas);\n\n      let players = [];\n      _.forEach(agg, (v, k) => {\n        players.push({\n          id: k,\n          x: v.x,\n          y: v.y,\n          img: v.img\n        });\n      });\n\n      resultCanvas.selectAll('.player')\n        .data(players)\n        .enter()\n        .append('image')\n        .classed('player', true)\n        .attr('xlink:href', d => d.img)\n        .attr('width', 50)\n        .attr('height', 50)\n        .attr('x', (d, i) => d.x)\n        .attr('y', (d, i) => d.y)\n        .style('opacity', 0.85)\n        .on('mouseover', (d) => {\n          const player = Stats.getPlayer(d.id);\n          resultCanvas.append('rect')\n            .classed('annotation', true)\n            .attr('x', d.x-2)\n            .attr('y', d.y-2)\n            .attr('width', 54)\n            .attr('height', 54)\n            .style('fill', 'none')\n            .style('stroke', '#389')\n            .style('stroke-width', 1);\n\n          resultCanvas.append('text')\n            .classed('annotation', true)\n            .attr('x', d.x+65)\n            .attr('y', d.y+10)\n            .style('stroke', 'none')\n            .style('fill', '#389')\n            .style('font-size', '13')\n            .text('AB: ' + formatter(player['AB']));\n          resultCanvas.append('text')\n            .classed('annotation', true)\n            .attr('x', d.x+65)\n            .attr('y', d.y+30)\n            .style('stroke', 'none')\n            .style('fill', '#389')\n            .style('font-size', '13')\n            .text('H: ' + formatter(player['H']));\n          resultCanvas.append('text')\n            .classed('annotation', true)\n            .attr('x', d.x+65)\n            .attr('y', d.y+50)\n            .style('stroke', 'none')\n            .style('fill', '#389')\n            .style('font-size', '13')\n            .text('HR: ' + formatter(player['HR']));\n        })\n        .on('mouseout', ()=> {\n          d3.selectAll('.annotation').remove();\n        })\n        .on('click', (d) => {\n          let url = 'https://www.baseball-reference.com/players/' + d.id.substring(0, 1) + '/' + d.id + '.shtml';\n          window.open(url);\n        });\n\n      let bars = chartCanvas.selectAll('.bar')\n        .data(this.scenario.players)\n        .enter()\n        .append('g')\n        .classed('bar', true)\n        .attr('transform', (d, i) => {\n          return 'translate(10,' + (5 + i*60) + ')';\n        });\n\n      bars.append('image')\n        .attr('width', 50)\n        .attr('height', 50)\n        .attr('xlink:href', d => d.img)\n        .style('cursor', 'pointer')\n        .on('click', (d) => {\n          let url = 'https://www.baseball-reference.com/players/' + d.id.substring(0, 1) + '/' + d.id + '.shtml';\n          window.open(url);\n        });\n\n\n      bars.append('rect')\n        .attr('x', 50)\n        .attr('y', 20)\n        .attr('height', 20)\n        .attr('width', (d) => {\n\n          const o = agg[d.id];\n          const dist = Math.sqrt( (o.x - d.x)*(o.x - d.x) + (o.y - d.y)*(o.y - d.y) );\n          return dist * 0.25;\n        })\n        .style('fill', '#F11');\n\n    },\n    create() {\n      this.scenario.players.forEach( player => {\n        player.x = 25 + Math.random()*(W - 50);\n        player.y = 25 + Math.random()*(H - 50);\n      });\n\n      function dragstarted(d) {\n        d3.selectAll('.annotation').remove();\n      }\n      function dragged(d) {\n        d3.select(this)\n          .attr(\"x\", () => {\n            d.x = d3.event.x;\n            return d.x;\n          })\n          .attr(\"y\", () => {\n            d.y = d3.event.y;\n            return d.y;\n          });\n      }\n      function dragended(d) {\n      }\n\n      const drag = d3.drag()\n        .on(\"start\", dragstarted)\n        .on(\"drag\", dragged)\n        .on(\"end\", dragended);\n        \n      this.canvas.selectAll('.player')\n        .data(this.scenario.players)\n        .enter()\n        .append('image')\n        .classed('player', true)\n        .attr('xlink:href', d => d.img)\n        .attr('width', 50)\n        .attr('height', 50)\n        .style('opacity', 0.85)\n        .attr('x', (d, i) => d.x)\n        .attr('y', (d, i) => d.y)\n        .on('mouseover', (d) => {\n          const player = Stats.getPlayer(d.id);\n          this.canvas.append('rect')\n            .classed('annotation', true)\n            .attr('x', d.x-2)\n            .attr('y', d.y-2)\n            .attr('width', 54)\n            .attr('height', 54)\n            .style('fill', 'none')\n            .style('stroke', '#389')\n            .style('stroke-width', 1);\n\n          this.canvas.append('text')\n            .classed('annotation', true)\n            .attr('x', d.x+65)\n            .attr('y', d.y+10)\n            .style('stroke', 'none')\n            .style('fill', '#389')\n            .style('font-size', '13')\n            .text('AB: ' + formatter(player['AB']));\n          this.canvas.append('text')\n            .classed('annotation', true)\n            .attr('x', d.x+65)\n            .attr('y', d.y+30)\n            .style('stroke', 'none')\n            .style('fill', '#389')\n            .style('font-size', '13')\n            .text('H: ' + formatter(player['H']));\n          this.canvas.append('text')\n            .classed('annotation', true)\n            .attr('x', d.x+65)\n            .attr('y', d.y+50)\n            .style('stroke', 'none')\n            .style('fill', '#389')\n            .style('font-size', '13')\n            .text('HR: ' + formatter(player['HR']));\n        })\n        .on('mouseout', ()=> {\n          d3.selectAll('.annotation').remove();\n        })\n        .on('click', (d) => {\n          let url = 'https://www.baseball-reference.com/players/' + d.id.substring(0, 1) + '/' + d.id + '.shtml';\n          window.open(url);\n        })\n        .call(drag);\n    },\n    initialize(canvas) {\n      d3.select('.survey-container')\n        .style('width', W+'px')\n        .style('height', H+'px');\n\n      d3.select('.result-container')\n        .style('width', W+'px')\n        .style('height', H+'px');\n\n      d3.select('.chart-container')\n        .style('width', '200px')\n        .style('height', H+'px');\n\n\n      const xmid = W * 0.5;\n      const ymid = H * 0.5;\n\n      const xaxis = this.scenario.xaxis;\n      const yaxis = this.scenario.yaxis;\n\n      canvas.append('rect')\n        .attr('x', 10)\n        .attr('y', ymid)\n        .attr('width', W-20)\n        .attr('height', 1)\n        .style('stroke', null)\n        .style('fill', '#AAA');\n\n      canvas.append('rect')\n        .attr('x', xmid)\n        .attr('y', 10)\n        .attr('width', 1)\n        .attr('height', H-20)\n        .style('stroke', null)\n        .style('fill', '#AAA');\n      \n      canvas.append('text')\n        .attr('x', 10)\n        .attr('y', ymid)\n        .style('font-weight', 600)\n        .text(xaxis[0]);\n\n      canvas.append('text')\n        .attr('x', W-10)\n        .attr('y', ymid)\n        .style('font-weight', 600)\n        .style('text-anchor', 'end')\n        .text(xaxis[1]);\n\n      canvas.append('text')\n        .attr('x', xmid)\n        .attr('y', 20)\n        .style('font-weight', 600)\n        .style('text-anchor', 'middle')\n        .text(yaxis[1]);\n\n      canvas.append('text')\n        .attr('x', xmid)\n        .attr('y', H-10)\n        .style('font-weight', 600)\n        .style('text-anchor', 'middle')\n        .text(yaxis[0]);\n    }\n  }\n}\n</script>\n\n<style>\n.main-container {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n}\n\n.survey, .result {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin-right: 20px;\n}\n\n.button {\n  margin: 5px;\n  padding: 3px;\n  background: #ddd;\n  border: 1px solid #444;\n  border-radius: 4px;\n  font-weight: 600;\n}\n\n.button:hover {\n  background: #eee;\n  cursor: pointer;\n}\n\nsvg {\n  width: 100%;\n  height: 100%;\n  border: 1px solid #ccc;\n  border-radius: 8px;\n}\n\n.player {\n  width: 30;\n  height: 30;\n  cursor: grab;\n}\n</style>\n\n\n\n\n// WEBPACK FOOTER //\n// src/components/survey.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"main-container\"},[_c('div',{staticClass:\"survey\"},[(_vm.scenario)?_c('span',[_c('strong',[_vm._v(_vm._s(_vm.scenario.name))])]):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"survey-container\"},[_c('svg',{staticClass:\"canvas-survey\"},[_c('g')])]),_vm._v(\" \"),_c('div',{staticStyle:{\"display\":\"flex\",\"flex-direction\":\"row\"}},[_c('div',{staticClass:\"button\",on:{\"click\":_vm.submit}},[_vm._v(\"Submit\")]),_vm._v(\" \"),_c('div',{staticClass:\"button\",on:{\"click\":_vm.view}},[_vm._v(\"View\")])])]),_vm._v(\" \"),(_vm.showResult === true)?_c('div',{staticClass:\"result\"},[(_vm.scenario)?_c('span',[_c('strong',[_vm._v(_vm._s(_vm.scenario.name)+\" (Average opinion)\")])]):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"result-container\"},[_c('svg',{staticClass:\"canvas-result\"},[_c('g')])]),_vm._v(\" \"),_c('div',{staticClass:\"button\",on:{\"click\":_vm.animate}},[_vm._v(\"Animate\")])]):_vm._e(),_vm._v(\" \"),(_vm.showResult === true)?_c('div',{staticClass:\"chart\"},[_vm._m(0),_vm._v(\" \"),_c('div',{staticClass:\"chart-container\"},[_c('svg',{staticClass:\"canvas-chart\"},[_c('g')])])]):_vm._e()])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',[_c('strong',[_vm._v(\"Difference\")])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-73806f92\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/survey.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-73806f92\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./survey.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./survey.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./survey.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-73806f92\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./survey.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/survey.vue\n// module id = null\n// module chunks = ","const players = [\n  { id: 'thomafr04', img: 'https://d3k2oh6evki4b7.cloudfront.net/req/201802130/images/headshots/e/e31675e7_davis.jpg' },\n  { id: 'troutmi01', img: 'https://d3k2oh6evki4b7.cloudfront.net/req/201802130/images/headshots/f/f322d40f_mlbam.jpg' },\n  { id: 'hamiljo03', img: 'https://d3k2oh6evki4b7.cloudfront.net/req/201802130/images/headshots/c/c5530155_mlbam.jpg' },\n  { id: 'belleal01', img: 'https://d3k2oh6evki4b7.cloudfront.net/req/201802130/images/headshots/1/1d993b9b_davis.jpg' },\n  { id: 'kershcl01', img: 'https://d3k2oh6evki4b7.cloudfront.net/req/201802130/images/headshots/0/0caa3053_mlbam.jpg' },\n  { id: 'harpebr03', img: 'https://d3k2oh6evki4b7.cloudfront.net/req/201802130/images/headshots/c/c61e922e_mlbam.jpg' },\n  { id: 'stantmi03', img: 'https://d3k2oh6evki4b7.cloudfront.net/req/201802130/images/headshots/8/87f6986b_mlbam.jpg' }\n];\n\nconst sc1 = {\n  id: 'hall-worth',\n  name: 'Hall of fame worthy',\n  players: players,\n  xaxis: ['Underrated', 'Overrated'],\n  yaxis: ['Replacement-level', 'Hall worthy']\n};\n\nconst sc2 = {\n  id: 'talented-jerk',\n  name: 'Talented or just a jerk',\n  players: players,\n  xaxis: ['Jerk', 'Nice'],\n  yaxis: ['Pedestrian', 'Talented']\n};\n\nconst sc3 = {\n  id: 'bench-or-start',\n  name: 'Starter or bench warmer',\n  players: players,\n  xaxis: ['Bench', 'Start'],\n  yaxis: ['', '']\n};\n\nconst sc4 = {\n  id: 'sc4',\n  name: 'Taking our the aggresions',\n  players: players,\n  xaxis: ['Too passive', 'Too aggressive'],\n  yaxis: ['Bad player', 'Good player']\n};\n\nconst sc5 = {\n  id: 'sc5',\n  name: 'Contract salary - what do they deserve',\n  players: players,\n  xaxis: ['1 million', '15 million'],\n  yaxis: ['1 year', '7 years']\n};\n\nconst sc6 = {\n  id: 'sc6',\n  name: 'Worst signing/trade ever',\n  players: players,\n  xaxis: ['Worst', 'Best'],\n  yaxis: ['Low impact', 'High impact']\n};\n\n\nconst scenarios = [\n  sc1, sc2, sc3, sc4, sc5, sc6\n];\n\n\nexport default class Scenarios {\n  static getScenario() {\n    return scenarios[4];\n  }\n\n  static getRandomScenario() {\n    const idx = Math.floor(Math.random() * scenarios.length);\n    return scenarios[idx];\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/scenarios.js","<template>\n  <div id=\"app\">\n    <h2>The Opinionator <i class=\"fa fa-refresh refresh\" @click=\"switchScenario\"></i></h2>\n    <div><small>Your opinion matters!!</small></div>\n    <survey :sc=\"scenario\"/>\n  </div>\n</template>\n\n<script>\nimport Survey from './components/survey';\nimport Scenarios from './util/scenarios';\nimport FB from './util/firebase';\nimport Stats from './util/stats';\n\nexport default {\n  name: 'App',\n  data() {\n    return {\n      scenario: null\n    };\n  },\n  components: {\n    Survey\n  },\n  mounted() {\n    FB.init();\n    this.scenario = Scenarios.getScenario();\n    d3.csv('static/Batting.csv', function(data) {\n      Stats.loadBatting(data);\n    });\n  },\n  methods: {\n    switchScenario() {\n      this.scenario = Scenarios.getRandomScenario();\n    }\n  }\n}\n</script>\n\n<style>\n#app {\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  margin-top: 10px;\n}\n\nh3, h2 {\n  margin-bottom: 5px;\n  margin-top: 5px;\n}\n\n\n.refresh:hover {\n  color: #F80;\n  cursor: pointer;\n}\n\nbody {\n  background: #FCFCFC;\n}\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('h2',[_vm._v(\"The Opinionator \"),_c('i',{staticClass:\"fa fa-refresh refresh\",on:{\"click\":_vm.switchScenario}})]),_vm._v(\" \"),_vm._m(0),_vm._v(\" \"),_c('survey',{attrs:{\"sc\":_vm.scenario}})],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('small',[_vm._v(\"Your opinion matters!!\")])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-0d899f4c\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-0d899f4c\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-0d899f4c\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue'\nimport App from './App'\n\nVue.config.productionTip = false\n\n/* eslint-disable no-new */\nnew Vue({\n  el: '#app',\n  components: { App },\n  template: '<App/>'\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}